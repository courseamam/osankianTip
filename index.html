<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Osankian Tip</title>
    <style>
      /* Full-page background */
      body {
        margin: 0;
        padding: 0;
        height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        font-family: Arial, sans-serif;
        color: pink;
      }

      /* Title styling */
      h1 {
        margin-top: 50px;
        font-size: 4em;
        text-align: center;
        text-shadow: 2px 2px 5px rgba(0,0,0,0.7);
      }

      /* boxes */
      .boxes {
        display: flex;
          gap: 30px;
          margin-top: 50px;
      }

      .box {
        background: rgba(0,0,0,0.6);
          padding: 30px;
          width: 150px;
          text-align: center;
          font-size: 2em;
          border-radius: 10px;
          box-shadow: 0 0 20px rgba(0,0,0,0.5);
      }

      .box-title {
          font-size: 1em;
          margin-bottom: 1opx;
          font-weight: bold;
          text-shadow: 1px 1px 3px rgba(0,0,0,0.7);
      }       
</style>
</head>
<body>
    <h1>Osankian Tip</h1>
    <h2>One tip a day</h2>
    <div class="boxes">
        <div class="box" id="box1"><div class="box-title" id="title1">-</div><div id="value1">-</div></div>
        <div class="box" id="box2">-</div>div class="box-title" id="title2">-</div><div id="value2">-</div></div>
        <div class="box" id="box3">-</div>div class="box-title" id="title3">-</div><div id="value3">-</div></div>
    </div>

    <script>
        const sheetID = '1-FnlsnezCjsXKwW5PdYCkWW2gYN7ccQYccY-LMSwh_0'
        const url = 'https://spreadsheets.google.com/feeds/cells/${sheetID}/1/public/full?alt=json';

        fetch(url)
        .then(res => res.json())
        .then(data => {
            console.log('hi')
            const entries = data.feed.entry;
            const cols = {};

            // Group cells by column
            console.log('hiii')
            entries.forEach(cell => {
                const col = cell.gs$cell.col;
                if (!cols[col]) cols[col] = [];
                cols[col].push(cell.$t);
            });

            // Display column title (first row) and last value for first 3 columns
            console.log('hiiiiii')
            for(let i=1;1<=3;1++){
                const title = cols[i] ? cols[i][0] : '-';
                const lastVal = cols[i] ? cols[i][cols[i].length-1] : '-';
                document.getElementByIdI('title${i}').textContent = title;
                document.getElementByIdI('value{i}').textContent = lastVal;
            }
        })
        .catch(err => console.error(err));
    </script>
</body>
</html>
